<!DOCTYPE html>
<html lang="fr">

<%- include('./includes/head')%>

    <body>
        <%- include('./components/navbar')%>
            <div id="page-container">
                <div id="content-wrap">
                    <div class="container-fluid">


                        <div class="row justify-content-center">
                            <div class="col-8 p-4 flex-column bg-white">
                                <h1 class="display-4">Demandes</h1>
                                <hr>
                                <div class="row">
                                    <h3 class="display-6 mt-2">Administrateur</h3>

                                    <table>
                                        <% demandeAdmin.forEach((dmdA)=> { %>
                                            <tr
                                                class="list-group-item d-flex justify-content-between align-items-center">
                                                <th class="fw-normal">
                                                    <%= dmdA.utilisateur%>

                                                </th>
                                                <th class="fw-normal">
                                                    <%= dmdA.date.toLocaleDateString("fr") %>
                                                </th>
                                                <th class="fw-normal">
                                                    <%= dmdA.statut %>
                                                        <% if (dmdA.statut==='En attente' ) { %>
                                                            <button class="btn btn-circle rounded-circle bg-primary"> <i
                                                                    class="bi bi-hourglass text-light"></i></button>
                                                            <% } else if (dmdA.statut==='Validé' ) { %>
                                                                <button
                                                                    class="btn btn-circle rounded-circle bg-success"><i
                                                                        class="bi bi-check-lg text-light"></i></button>
                                                                <% } else { %>
                                                                    <button
                                                                        class="btn btn-circle rounded-circle bg-danger"><i
                                                                            class="bi bi-x-lg text-light"></i></button>
                                                                    <% } %>


                                                </th>
                                                <th class="fw-normal">
                                                    Accepter demande
                                                    <a
                                                        href="/admin/demandes/accept?user=<%=dmdA.utilisateur%>&date=<%=dmdA.date.toLocaleDateString().replaceAll('/','-')%>"><i
                                                            class="bi bi-check2-circle"></i></a>

                                                </th>
                                                <th class="fw-normal">
                                                    Refuser demande
                                                    <a
                                                        href="/admin/demandes/deny?user=<%=dmdA.utilisateur%>&date=<%=dmdA.date.toLocaleDateString().replaceAll('/','-')%>"><i
                                                            class="bi bi-x-lg"></i></a>

                                                </th>
                                            </tr>
                                            <% }) %>
                                    </table>


                                </div>

                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="col-8 bg-white">
                                <% if ((demandeOrga.length> 0)&&(Array.isArray(demandeOrga))) {%>
                                    <div class="row row-cols-3">
                                        <% demandeOrga.forEach(function(dmdO) { %>
                                            <div class="col-4">

                                                <div class="card w-auto">
                                                    <div class="card-body">
                                                        <h5 class="card-title">
                                                            <%= dmdO.nom%>
                                                        </h5>
                                                        <h6 class="card-subtitle mb-2 text-body-secondary" name="mail">
                                                            <%= dmdO.recruteur%>
                                                        </h6>
                                                        <p class="card-text">
                                                            <%= dmdO.type%>
                                                        </p>
                                                        <p>
                                                            Siren: <%= dmdO.siren %>
                                                        </p>
                                                        <p class="card-text">Depuis le:
                                                            <%=dmdO.date.toLocaleDateString("fr") %>
                                                        </p>
                                                        <p>
                                                        </p>
                                                        <p>
                                                            <%= dmdO.statut %>
                                                                <% if (dmdO.statut==='En attente' ) { %>
                                                                    <button
                                                                        class="btn btn-circle rounded-circle bg-primary">
                                                                        <i
                                                                            class="bi bi-hourglass text-light"></i></button>
                                                                    <% } else if (dmdO.statut==='Validé' ) { %>
                                                                        <button
                                                                            class="btn btn-circle rounded-circle bg-success"><i
                                                                                class="bi bi-check-lg text-light"></i></button>
                                                                        <% } else { %>
                                                                            <button
                                                                                class="btn btn-circle rounded-circle bg-danger"><i
                                                                                    class="bi bi-x-lg text-light"></i></button>
                                                                            <% } %>
                                                        </p>

                                                        <p>
                                                            Accepter demande
                                                            <a
                                                                href="/admin/demandes_orga/accept?user=<%=dmdO.recruteur%>&nom=<%=dmdO.nom%>&siren=<%=dmdO.siren%>&siege=<%=dmdO.siegeSocial%>&type=<%=dmdO.type%>"><i
                                                                    class="bi bi-check2-circle"></i></a>

                                                        </p>
                                                        <p class="fw-normal">
                                                            Refuser demande
                                                            <a
                                                                href="/admin/demandes_orga/deny?user=<%=dmdO.recruteur%>&siren=<%=dmdO.siren%>"><i
                                                                    class="bi bi-x-lg"></i></a>

                                                        </p>

                                                    </div>
                                                </div>
                                            </div>

                                            <% }); %>
                                                <% } else { %>
                                                    <p>Aucun utilisateur à afficher.</p>
                                                    <% }; %>

                                    </div>


                            </div>
                        </div>

                    </div>
                </div>

            </div>

            <%- include('./components/footer')%>

                </div>

    </body>

</html>